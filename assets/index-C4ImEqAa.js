import{t as v,e as xe,c as $e,f as Ce}from"./main-sIgzr7l1.js";import{k as J,a9 as E,a6 as ue,r as i,a7 as O,W as R,a2 as n,N as a,_ as e,X as S,j as m,Y as C,w as Re,V as Me,I as q,Z as K,af as le,a4 as oe}from"./vue-DuawIF-O.js";import{m as Be,b as Ie,a as Ue,c as Ae,d as Te,e as ze,f as he,g as Se}from"./menu-T1XsJnm3.js";import{b as re,d as Q,e as W,s as X,L as Y,M as Z,c as H,o as qe,p as De,O as Ee,J as Fe,P as Le,B as j,r as D,Q as Pe,R as Ge,T as Ve,K as se}from"./naive-ui-CQ2AL4ly.js";const Ke=J({__name:"MenuAddModal",props:E({type:{},parent:{}},{show:{type:Boolean,required:!0},showModifiers:{}}),emits:E(["success"],["update:show"]),setup(g,{emit:M}){const y=ue(g,"show"),N=M,s=i({}),r=O("formRef"),k={name:[{required:!0,message:"请输入菜单名称",trigger:["blur","input"]}],sort:[{required:!0,message:"请输入排序",type:"number",trigger:["blur","input"]}],status:[{required:!0,message:"请选择状态",type:"number",trigger:["blur","change"]}]},w=i(!1);async function A(){var f;const[d]=await v(r.value.validate());if(d)return!1;w.value=!0;const[o]=await v(Be({...a(s),parentId:g.type===1?0:g.parent.id}));if(w.value=!1,!o)return(f=window.$message)==null||f.success("新增成功"),N("success"),!0}return(d,o)=>{const f=W,c=Q,x=X,$=Z,B=Y,I=H,T=re;return C(),R(T,{show:y.value,"onUpdate:show":o[3]||(o[3]=u=>y.value=u),preset:"dialog",title:d.type===1?"添加顶级菜单":"添加子菜单","positive-text":"确定","negative-text":"取消",loading:a(w),onPositiveClick:A},{default:n(()=>[e(I,{ref_key:"formRef",ref:r,model:a(s),rules:k,class:"my-8",size:"small","label-placement":"left","label-width":"auto"},{default:n(()=>[d.type===2?(C(),R(c,{key:0,label:"上级菜单"},{default:n(()=>{var u;return[e(f,{value:(u=d.parent)==null?void 0:u.name,disabled:""},null,8,["value"])]}),_:1})):S("",!0),e(c,{label:"菜单名称",path:"name"},{default:n(()=>[e(f,{value:a(s).name,"onUpdate:value":o[0]||(o[0]=u=>a(s).name=u),placeholder:"菜单名称"},null,8,["value"])]),_:1}),e(c,{label:"排序",path:"sort"},{default:n(()=>[e(x,{value:a(s).sort,"onUpdate:value":o[1]||(o[1]=u=>a(s).sort=u),min:1,precision:0,placeholder:"序号"},null,8,["value"])]),_:1}),e(c,{label:"状态",path:"status"},{default:n(()=>[e(B,{value:a(s).status,"onUpdate:value":o[2]||(o[2]=u=>a(s).status=u)},{default:n(()=>[e($,{value:1},{default:n(()=>o[4]||(o[4]=[m("启用")])),_:1}),e($,{value:0},{default:n(()=>o[5]||(o[5]=[m("禁用")])),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title","loading"])}}}),je=J({__name:"ButtonAddModal",props:E({parent:{}},{show:{type:Boolean,required:!0},showModifiers:{}}),emits:E(["success"],["update:show"]),setup(g,{emit:M}){const y=ue(g,"show"),N=M,s=i({}),r=O("formRef"),k={name:[{required:!0,message:"请输入菜单名称",trigger:["blur","input"]}],sort:[{required:!0,message:"请输入排序",type:"number",trigger:["blur","input"]}],status:[{required:!0,message:"请选择状态",type:"number",trigger:["blur","change"]}]},w=i(!1);async function A(){var f;const[d]=await v(r.value.validate());if(d)return!1;w.value=!0;const[o]=await v(g.parent?Ie({...a(s),parentId:g.parent.id}):Ue(s.value));if(w.value=!1,!o)return(f=window.$message)==null||f.success(`${g.parent?"新增":"编辑"}成功`),N("success"),!0}return(d,o)=>{const f=W,c=Q,x=X,$=Z,B=Y,I=H,T=re;return C(),R(T,{show:y.value,"onUpdate:show":o[3]||(o[3]=u=>y.value=u),preset:"dialog",title:d.parent?"添加按钮":"编辑按钮","positive-text":"确定","negative-text":"取消",loading:a(w),onPositiveClick:A},{default:n(()=>[e(I,{ref_key:"formRef",ref:r,model:a(s),rules:k,class:"my-8",size:"small","label-placement":"left","label-width":"auto"},{default:n(()=>[d.parent?(C(),R(c,{key:0,label:"上级菜单"},{default:n(()=>{var u;return[e(f,{value:(u=d.parent)==null?void 0:u.name,disabled:""},null,8,["value"])]}),_:1})):S("",!0),e(c,{label:"按钮名称",path:"name"},{default:n(()=>[e(f,{value:a(s).name,"onUpdate:value":o[0]||(o[0]=u=>a(s).name=u),placeholder:"按钮名称"},null,8,["value"])]),_:1}),e(c,{label:"排序",path:"sort"},{default:n(()=>[e(x,{value:a(s).sort,"onUpdate:value":o[1]||(o[1]=u=>a(s).sort=u),min:1,precision:0,placeholder:"排序"},null,8,["value"])]),_:1}),e(c,{label:"状态",path:"status"},{default:n(()=>[e(B,{value:a(s).status,"onUpdate:value":o[2]||(o[2]=u=>a(s).status=u)},{default:n(()=>[e($,{value:1},{default:n(()=>o[4]||(o[4]=[m("启用")])),_:1}),e($,{value:0},{default:n(()=>o[5]||(o[5]=[m("禁用")])),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show","title","loading"])}}}),Je={class:"my-4"},Oe={class:"w-full flex items-center gap-4"},Qe={class:"w-full flex-center"},He=J({name:"setting-menu",__name:"index",setup(g){const M=i([]),y=i(!1),N=i([]),s=i({}),r=i();async function k(){y.value=!0;const[l,t]=await v(Ae());y.value=!1,!l&&(M.value=t)}k();function w(l){return e(D,{align:"center"},{default:()=>[e(se,{class:"text-sm",type:"primary"},{default:()=>[l.option.code]}),e("div",{class:"i-tabler:copy text-base text-primary",onClick:oe(()=>{d(l.option.code)},["stop"])},null)]})}const{copy:A}=xe();async function d(l){var p,U;const[t]=await v(A(l));t?(p=window.$message)==null||p.error("复制失败"):(U=window.$message)==null||U.success("复制成功")}const o=i("");function f({option:l}){return{onClick(){var t;if(l.id===((t=r.value)==null?void 0:t.id)){r.value=void 0;return}r.value=l,s.value=Ce(l)}}}function c(){r.value=void 0,N.value=[]}const x=i(!1),$=i(1);function B(l){$.value=l,x.value=!0}const I=O("formRef"),T={name:[{required:!0,message:"请输入菜单名称",trigger:["blur","input"]}],sort:[{required:!0,message:"请输入排序",type:"number",trigger:["blur","input"]}],status:[{required:!0,message:"请选择状态",type:"number",trigger:["blur","change"]}]},u=i(!1);async function ie(){var p;const[l]=await v(I.value.validate());if(l)return;u.value=!0;const[t]=await v(Te(s.value));u.value=!1,!t&&((p=window.$message)==null||p.success("保存成功"),k())}function de(){var t;const l=window.$dialog.warning({title:"温馨提示",content:`确定要删除“${(t=r.value)==null?void 0:t.name}”吗？`,positiveText:"确定",negativeText:"取消",onPositiveClick:async()=>{l.loading=!0;const[p]=await v(ze(r.value.id));return l.loading=!1,p?!1:(window.$message.success("删除成功"),k(),c(),!0)}})}const z=i(!1),ee=i(),F=i([]),pe=[{title:"按钮名称",key:"name"},{title:"按钮code",key:"code",render(l){return e(D,{align:"center"},{default:()=>[e(se,{class:"text-sm",type:"info"},{default:()=>[l.code]}),e("div",{class:"i-tabler:copy cursor-pointer text-base text-primary",onClick:oe(()=>{d(l.code)},["stop"])},null)]})}},{title:"排序",key:"sort"},{title:"状态",key:"status",render(l){return e(Ve,{type:l.status===1?"success":"error"},{default:()=>[l.status===1?"启用":"禁用"]})}},{title:"操作",key:"action",width:120,render(l){return e(D,null,{default:()=>[e(j,{type:"info",size:"small",text:!0,onClick:()=>fe(l)},{default:()=>[m("编辑")]}),e(j,{type:"error",size:"small",text:!0,onClick:()=>ce(l)},{default:()=>[m("删除")]})]})}}],L=i(!1);async function P(){L.value=!0;const[l,t]=await v(Se(r.value.id));if(L.value=!1,l){F.value=[];return}F.value=t}function me(){ee.value=void 0,z.value=!0}Re(r,l=>{l&&P()});function fe(l){ee.value=l,z.value=!0}function ce(l){const t=window.$dialog.warning({title:"温馨提示",content:`确定要删除“${l.name}”吗？`,positiveText:"确定",negativeText:"取消",onPositiveClick:async()=>{t.loading=!0;const[p]=await v(he(l.id));return t.loading=!1,p?!1:(window.$message.success("删除成功"),P(),!0)}})}return(l,t)=>{const p=j,U=W,_e=Le,G=Fe,ve=Ee,V=De,te=Pe,ne=D,h=Q,ge=$e,ye=X,ae=Z,we=Y,be=H,Ne=Ge,ke=qe;return C(),Me("div",null,[e(ke,{cols:"1 800:2 1200:3","x-gap":16,"y-gap":16},{default:n(()=>[e(V,null,{default:n(()=>[e(ve,{show:a(y)},{default:n(()=>[e(G,{title:"菜单管理",size:"small"},{"header-extra":n(()=>[e(p,{type:"primary",size:"small",onClick:t[0]||(t[0]=_=>B(1))},{default:n(()=>t[11]||(t[11]=[m("添加顶级菜单")])),_:1})]),default:n(()=>[K("div",Je,[e(U,{value:a(o),"onUpdate:value":t[1]||(t[1]=_=>q(o)?o.value=_:null),placeholder:"搜索菜单"},null,8,["value"])]),e(_e,{"selected-keys":a(N),"onUpdate:selectedKeys":t[2]||(t[2]=_=>q(N)?N.value=_:null),data:a(M),pattern:a(o),"block-line":"","label-field":"name","key-field":"id","render-suffix":w,"show-irrelevant-nodes":!0,"node-props":f},null,8,["selected-keys","data","pattern"])]),_:1})]),_:1},8,["show"])]),_:1}),e(V,null,{default:n(()=>{var _;return[e(G,{size:"small",title:(_=a(r))==null?void 0:_.name},le({default:n(()=>[e(te,{title:"温馨提示",type:"info"},{default:n(()=>t[12]||(t[12]=[m("点击菜单开始")])),_:1}),a(r)?(C(),R(be,{key:0,ref_key:"formRef",ref:I,model:a(s),rules:T,class:"my-4",size:"small","label-placement":"left","label-width":"auto"},{default:n(()=>[e(h,{label:"菜单名称",path:"name"},{default:n(()=>[e(U,{value:a(s).name,"onUpdate:value":t[4]||(t[4]=b=>a(s).name=b),placeholder:"菜单名称"},null,8,["value"])]),_:1}),e(h,{label:"菜单code",path:"code"},{default:n(()=>[K("div",Oe,[e(U,{value:a(s).code,"onUpdate:value":t[5]||(t[5]=b=>a(s).code=b),disabled:"",placeholder:"菜单code",class:"flex-1"},null,8,["value"]),e(ge,{icon:"i-tabler:copy",class:"cursor-pointer text-base text-primary",onClick:t[6]||(t[6]=b=>d(a(s).code))})])]),_:1}),e(h,{label:"排序",path:"sort"},{default:n(()=>[e(ye,{value:a(s).sort,"onUpdate:value":t[7]||(t[7]=b=>a(s).sort=b),min:1,precision:0,placeholder:"序号"},null,8,["value"])]),_:1}),e(h,{label:"状态",path:"status"},{default:n(()=>[e(we,{value:a(s).status,"onUpdate:value":t[8]||(t[8]=b=>a(s).status=b)},{default:n(()=>[e(ae,{value:1},{default:n(()=>t[15]||(t[15]=[m("启用")])),_:1}),e(ae,{value:0},{default:n(()=>t[16]||(t[16]=[m("禁用")])),_:1})]),_:1},8,["value"])]),_:1}),e(h,null,{default:n(()=>[K("div",Qe,[e(p,{loading:a(u),type:"primary","attr-type":"submit",size:"small",onClick:ie},{default:n(()=>t[17]||(t[17]=[m("保存")])),_:1},8,["loading"])])]),_:1})]),_:1},8,["model"])):S("",!0)]),_:2},[a(r)?{name:"header-extra",fn:n(()=>[e(ne,null,{default:n(()=>[e(p,{type:"primary",ghost:"",size:"small",onClick:t[3]||(t[3]=b=>B(2))},{default:n(()=>t[13]||(t[13]=[m("添加子菜单")])),_:1}),e(p,{type:"error",ghost:"",size:"small",onClick:de},{default:n(()=>t[14]||(t[14]=[m("删除")])),_:1})]),_:1})]),key:"0"}:void 0]),1032,["title"])]}),_:1}),e(V,null,{default:n(()=>[e(G,{size:"small",title:"按钮管理"},le({default:n(()=>[a(r)?S("",!0):(C(),R(te,{key:0,title:"温馨提示",type:"info"},{default:n(()=>t[18]||(t[18]=[m("点击菜单开始")])),_:1})),a(r)?(C(),R(Ne,{key:1,size:"small",class:"mt-4",columns:pe,data:a(F),loading:a(L)},null,8,["data","loading"])):S("",!0)]),_:2},[a(r)?{name:"header-extra",fn:n(()=>[e(ne,null,{default:n(()=>[e(p,{type:"primary",ghost:"",size:"small",onClick:me},{default:n(()=>t[19]||(t[19]=[m("添加按钮")])),_:1})]),_:1})]),key:"0"}:void 0]),1024)]),_:1})]),_:1}),e(Ke,{show:a(x),"onUpdate:show":t[9]||(t[9]=_=>q(x)?x.value=_:null),type:a($),parent:a(r),onSuccess:k},null,8,["show","type","parent"]),e(je,{show:a(z),"onUpdate:show":t[10]||(t[10]=_=>q(z)?z.value=_:null),parent:a(r),onSuccess:P},null,8,["show","parent"])])}}});export{He as default};
